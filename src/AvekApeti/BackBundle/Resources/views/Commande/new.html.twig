{% extends "AvekApetiBackBundle:Main:index.html.twig" %}

{% block titre %} {{ parent() }}{% endblock %}

{% block content -%}

    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">Nouvelle Commande</h1>
        </div>

        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="row">
                        <div class="col-lg-6">
                            {{ form_start(form) }}
                                <div class="form-group">
                                    {{ form_label(form.total, 'Total') }}
                                    {{ form_widget(form.total, {'attr': {'class': 'form-control', 'placeholder':"total"}}) }}
                                    <p class="help-block text-danger">{{ form_errors(form.total) }}</p>
                                </div>
                                <div class="form-group">
                                    {{ form_label(form.status, 'Statut') }}
                                    {{ form_widget(form.status, {'attr': {'class': 'form-control', 'placeholder':"Statut"}}) }}
                                    <p class="help-block text-danger">{{ form_errors(form.status) }}</p>
                                </div>
                                <div class="form-group">
                                    {{ form_label(form.Utilisateur, 'Gourmet') }}
                                    {{ form_widget(form.Utilisateur, {'attr': {'class': 'form-control'}}) }}
                                    <p class="help-block text-danger">{{ form_errors(form.Utilisateur) }}</p>
                                </div>
                                <div class="form-group">
                                    {{ form_label(form.Chef, 'Chef') }}
                                    {{ form_widget(form.Chef, {'attr': {'class': 'form-control'}}) }}
                                    <p class="help-block text-danger">{{ form_errors(form.Chef) }}</p>
                                </div>
                                <div class="form-group">
                                    {{ form_label(form.content, 'Description') }}
                                    {{ form_widget(form.content, {'attr': {'class': 'form-control', 'placeholder':"Description"}}) }}
                                    <p class="help-block text-danger">{{ form_errors(form.content) }}</p>
                                </div>
                                <div class="form-group">
                                    {{ form_label(form.typecommande, 'Type de repas') }}
                                    {{ form_widget(form.typecommande, {'attr': {'class': 'form-control'}}) }}
                                    <p class="help-block text-danger">{{ form_errors(form.typecommande) }}</p>
                                </div>
                                <div class="form-group">
                                    {{ form_label(form.livraison, 'Type de livraison') }}
                                    {{ form_widget(form.livraison, {'attr': {'class': 'form-control'}}) }}
                                    <p class="help-block text-danger">{{ form_errors(form.livraison) }}</p>
                                </div>
                                <div class="form-group">
                                    {{ form_label(form.commandeplat, 'Plat') }}
                                    {{ form_widget(form.commandeplat, {'attr': {'class': 'form-control'}}) }}
                                    <p class="help-block text-danger">{{ form_errors(form.commandeplat) }}</p>
                                </div>
                                <div class="form-group">
                                    <button id="but_plat" class="btn btn-default">Ajout Plat</button>
                                    {#<button id="but_menu" class="btn btn-default">Ajout Menu</button>#}
                                </div>
                                <div class="form-group">
                                    <div><span class="gras">Plat ajouté : </span><span id="res_plat"></span></div>
                                    {#<div><span class="gras">Menu ajouté : </span><span id="res_menu"></span></div>#}
                                </div>
                                <div class="col-md-12">
                                    <div id="success"></div>
                                    <a href="{{ path('commande') }}" class="btn btn-info">Retour à la liste</a>
                                    <button type="submit" class="btn btn-primary">Enregistrer</button>
                                    <hr>
                                </div>



                            {{ form_end(form) }}
                        </div>
                    </div>
                    <!-- /.row (nested) -->
                </div>
                <!-- /.panel-body -->
            </div>
            <!-- /.panel -->
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
    
    <script type="text/javascript" src="{{ asset('bundles/gourmet/js/template/jquery.js') }}"></script>
    
    <script>
        var commande_plat = [];
        var commande_menu = [];

        $('#but_plat').click(function(){

            var Plat = $('#avekapeti_backbundle_commande_commandeplat').val();
            var Done = true;
            if(Plat == null)
            {
                return ;
            }
            for(index = 0; index < commande_plat.length; ++index) {

                if(commande_plat[index][0] == Plat)
                {
                    commande_plat[index][1] = commande_plat[index][1]+1;
                    Done = false;
                }
            }

            if((index == commande_plat.length) && Done)
            {
                commande_plat.push([$('#avekapeti_backbundle_commande_commandeplat').val(),1]);
            }
            $('#res_plat').html(commande_plat);
            $('#avekapeti_backbundle_commande_liste_plats').val(tabString(commande_plat));

        });
        $('#but_menu').click(function(){

            var Menu = $('#avekapeti_backbundle_commande_commandemenu').val();
            var Done = true;

            if(Menu == null)
            {
                return;
            }
            for(index = 0; index < commande_menu.length; ++index) {

                if(commande_menu[index][0] == Menu)
                {
                    commande_menu[index][1] = commande_menu[index][1]+1;
                    Done = false;
                }
            }

            if((index == commande_menu.length) && Done)
            {
                commande_menu.push([$('#avekapeti_backbundle_commande_commandemenu').val(),1]);
            }
            $('#res_menu').html(commande_menu);
            $('#avekapeti_backbundle_commande_liste_plats').val(tabString(commande_menu));
        });

        function tabString(Tab){
            var string = "";
            for(index = 0; index < Tab.length; ++index) {
                string = string+Tab[index]+';';

            }
            return string;
        }
    </script>
    
{% endblock content %}
